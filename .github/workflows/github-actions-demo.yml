name: GitHub Actions Demo
on: 
  push:
    paths:
      - 'project1/**'
  pull_request:
    branches:
      - master
jobs:
  Explore-GitHub-Actions:
    runs-on: ubuntu-latest
    strategy:
      matrix:
        python-version: [3.7]
    steps:
      - run: echo "🎉 The job was automatically triggered by a ${{ github.event_name }} event."
      - run: echo "🐧 This job is now running on a ${{ runner.os }} server hosted by GitHub!"
      - run: echo "🔎 The name of your branch is ${{ github.ref }} and your repository is ${{ github.repository }}."
      - name: Check out repository code
        uses: actions/checkout@v2
      - name: Set up Python ${{ matrix.python-version }}
        uses: actions/setup-python@v2
        with:
          python-version: ${{ matrix.python-version }}
      - name: Working directory
        working-directory: ./project1
        run: python helloworld.py
      - run: echo "💡 The ${{ github.repository }} repository has been cloned to the runner."
      - run: echo "🖥️ The workflow is now ready to test your code on the runner."
      - name: List files in the repository
        run: |
          ls ${{ github.workspace }}
      - run: echo "🍏 This job's status is ${{ job.status }}."
  changedfiles:
      runs-on: ubuntu-latest
      # Map a step output to a job output
      outputs:
        all: ${{ steps.changes.outputs.all }}
        ts: ${{ steps.changes.outputs.ts }}
      steps:
          # Make sure we have some code to diff.
        - name: Checkout repository
          uses: actions/checkout@v2
        - name: Get changed files
          id: changes
          # Set outputs using the command.
          run: |
            echo "base_ref ${{github.base_ref}} head_ref ${{github.head_ref}}"
            echo "::set-output name=all::$(git diff --name-only --diff-filter=ACMRT origin/master | xargs)"
            echo "::set-output name=ts::$(git diff --name-only --diff-filter=ACMRT origin/master | grep .json)"
  lint:
    runs-on: ubuntu-latest
    # require the first job to have ran
    needs: changedfiles
    # only run there are changed files
    if: ${{needs.changedfiles.outputs.ts}}
    steps:
      - name: echo changed files
        run: echo ${{needs.changedfiles.outputs.ts}}